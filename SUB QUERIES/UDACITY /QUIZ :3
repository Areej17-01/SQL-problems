SELECT CHANNEL,SUM(TOTAL)/COUNT(TOTAL)
FROM
(SELECT DATE_TRUNC('DAY',occurred_at),
CHANNEL,
COUNT(CHANNEL) TOTAL
FROM Web_events
GROUP BY 2,1) SUB
GROUP BY 1
ORDER BY 2 DESC
